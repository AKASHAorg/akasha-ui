{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "profile-avatar",
  "type": "registry:ui",
  "dependencies": [
    "@radix-ui/react-avatar",
    "lucide-react"
  ],
  "files": [
    {
      "path": "ui/profile-avatar.tsx",
      "content": "\"use client\";\n\nimport * as React from \"react\";\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\";\nimport { cva, type VariantProps } from \"class-variance-authority\";\nimport { EyeOff } from \"lucide-react\";\n\nimport { cn } from \"@/lib/utils\";\nimport { getImageFromSeed } from \"@/registry/default/lib/get-image-from-seed\";\n\nconst profileAvatarVariants = cva(\n  \"relative flex shrink-0 justify-center items-center overflow-hidden rounded-full\",\n  {\n    variants: {\n      size: {\n        xl: \"size-20 [&_svg]:size-8\",\n        lg: \"size-10 [&_svg]:size-4\",\n        md: \"size-8 [&_svg]:size-3\",\n        sm: \"size-6 [&_svg]:size-3\",\n        xs: \"size-4 [&_svg]:size-3\",\n      },\n    },\n    defaultVariants: {\n      size: \"lg\",\n    },\n  }\n);\n\nconst ProfileAvatarContext = React.createContext<{\n  profileDID: string;\n  publicImgPath: string;\n  nsfw: boolean;\n} | null>(null);\n\nconst useAvatarContext = () => {\n  const context = React.useContext(ProfileAvatarContext);\n  if (!context) {\n    throw new Error(\n      \"`useAvatarContext` must be used within an `ProfileAvatar` component\"\n    );\n  }\n  return context;\n};\n\nconst ProfileAvatar = ({\n  profileDID = \"\",\n  publicImgPath = \"/images\",\n  nsfw = false,\n  size,\n  className,\n  ...props\n}: React.ComponentProps<typeof AvatarPrimitive.Root> &\n  VariantProps<typeof profileAvatarVariants> & {\n    profileDID?: string;\n    publicImgPath?: string;\n    nsfw?: boolean;\n  }) => {\n  return (\n    <ProfileAvatarContext.Provider value={{ nsfw, profileDID, publicImgPath }}>\n      <AvatarPrimitive.Root\n        data-slot=\"profile-avatar\"\n        className={cn(\n          profileAvatarVariants({\n            size,\n            className,\n          }),\n          nsfw && \"bg-muted\"\n        )}\n        {...props}\n      />\n    </ProfileAvatarContext.Provider>\n  );\n};\n\nconst ProfileAvatarImage = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof AvatarPrimitive.Image> & {\n  nsfw?: boolean;\n}) => {\n  const { nsfw } = useAvatarContext();\n  return nsfw ? (\n    <EyeOff className={cn(\"text-destructive\", className)} />\n  ) : (\n    <AvatarPrimitive.Image\n      data-slot=\"profile-avatar-image\"\n      className={cn(\"aspect-square h-full w-full\", className)}\n      {...props}\n      onLoadingStatusChange={() => {}}\n    />\n  );\n};\n\nconst ProfileAvatarFallback = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<typeof AvatarPrimitive.Fallback>) => {\n  const { profileDID, publicImgPath, nsfw } = useAvatarContext();\n\n  const seed = getImageFromSeed(profileDID, 7);\n  const avatarFallback = `${publicImgPath}/avatar-${seed}-min.webp`;\n  return (\n    !nsfw && (\n      <AvatarPrimitive.Fallback\n        data-slot=\"profile-avatar-fallback\"\n        className={cn(\n          \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n          className\n        )}\n        {...props}\n      >\n        {React.Children.count(children) ? (\n          children\n        ) : (\n          <img\n            data-slot=\"image\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            src={avatarFallback}\n            alt=\"fallback\"\n            className=\"object-contain\"\n          />\n        )}\n      </AvatarPrimitive.Fallback>\n    )\n  );\n};\n\nexport {\n  ProfileAvatar,\n  ProfileAvatarImage,\n  ProfileAvatarFallback,\n  profileAvatarVariants,\n};\n",
      "type": "registry:ui"
    },
    {
      "path": "lib/get-image-from-seed.ts",
      "content": "/**\n * Utility function to generate avatar placeholders from seed (could be ETH address or DID etc).\n * Helpful for when avatar is null or undefined\n * @param seed - string or null\n * @returns placeholder image number\n */\nexport const getImageFromSeed = (\n  seed: string | null,\n  numberOfPlaceholders: number\n) => {\n  let str = seed;\n\n  if (seed && seed.search(\"0x\") != -1) {\n    str = seed.replace(\"0x\", \"\");\n  }\n\n  if (str && str.length) {\n    const avatarOption = Array.from(str).reduce(\n      (sum: number, letter: string) => {\n        if (parseInt(letter, 10)) {\n          return sum + parseInt(letter, 10);\n        }\n        return sum;\n      },\n      0\n    );\n\n    /**\n     * if user is a visitor his address is 0x0000... so sum is 0\n     * you can give him a specific placeholder\n     */\n    if (avatarOption === 0) {\n      return numberOfPlaceholders;\n    }\n\n    return (avatarOption % (numberOfPlaceholders - 1)) + 1;\n  }\n  // load the first placeholder, just to not throw and error\n  return numberOfPlaceholders;\n};\n",
      "type": "registry:lib"
    }
  ]
}